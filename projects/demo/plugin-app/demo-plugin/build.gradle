apply from: "../../plugin-app/demo-install/build.gradle"

android {
    defaultConfig {
        applicationId "com.tencent.shadow.demo_host"
    }
}

buildscript {
    repositories {
        maven {
            url "http://maven.oa.com/nexus/content/repositories/jcenter"
        }
        maven {
            url "http://maven.oa.com/nexus/content/repositories/google-maven/"
        }
    }

    dependencies {
        classpath 'com.tencent.shadow.core:runtime-debug'
        classpath 'com.tencent.shadow.core:gradle-plugin'
        classpath 'org.javassist:javassist:3.22.0-GA'
    }
}

apply plugin: 'com.tencent.shadow.plugin'


shadow {
    transform {
//        useHostContext = ['abc']
    }

    packagePlugin {
        pluginTypes {
            debug {
                loaderApkConfig = new Tuple2('loader-apk-debug.apk', ':projects:demo:loader-apk:assembleDebug')
                runtimeApkConfig = new Tuple2('runtime-apk-debug.apk', ':projects:demo:runtime-apk:assembleDebug')
                pluginApks {
                    pluginApk1 {
                        businessName = 'demo'
                        partKey = 'demo_main'
                        buildTask = 'assembleDebug'
                        apkName = 'demo-plugin-debug.apk'
                        projectPath = 'projects/demo/plugin-app/demo-plugin'
                        hostWhiteList = ["androidx.test.espresso",//这个包添加是为了插件demo中可以访问测试框架的类
                                         "com.tencent.shadow.demo.interfaces"]//测试插件访问宿主白名单类
                    }
                }
            }

            release {
                loaderApkConfig = new Tuple2('loader-apk-release.apk', ':projects:demo:loader-apk:assembleRelease')
                runtimeApkConfig = new Tuple2('runtime-apk-release.apk', ':projects:demo:runtime-apk:assembleRelease')
                pluginApks {
                    pluginApk1 {
                        businessName = 'demo'
                        partKey = 'demo_main'
                        buildTask = 'assembleRelease'
                        apkName = 'demo-plugin-release.apk'
                        projectPath = 'projects/demo/plugin-app/demo-plugin'
                        hostWhiteList = ["androidx.test.espresso",//这个包添加是为了插件demo中可以访问测试框架的类
                                         "com.tencent.shadow.demo.interfaces"]//测试插件访问宿主白名单类
                    }
                }
            }
        }

        loaderApkProjectPath = 'projects/demo/loader-apk'

        runtimeApkProjectPath = 'projects/demo/runtime-apk'

        version = 4
        compactVersion = [1, 2, 3]
        uuidNickName = "1.1.5"
    }
}